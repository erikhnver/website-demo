<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sportverein Esperke</title>
    <link rel="stylesheet" href="style_termine.css">
    <link rel="icon" type="image/png" href="SVE_Logo.png" />
</head>

<body>
    <header>
        <nav>
            <div class="logo">
                <img src="SVE_Logo.png" alt="SV Esperke Logo">
            </div>
            <ul class="nav-links">
                <li><a href="index.html"><h3>Startseite</h3></a></li>
                <li><a href="ueberuns.html"><h3>Über uns</h3></a></li>
    
                <!-- Dropdown Fußball -->
                <li class="dropdown">
                    <a href="fussball.html"><h3>Fußball <span class="arrow-down">▼</span></h3></a>
                    <ul class="dropdown-content">
                        <li><a href="herren.html">Herren</a></li>
                        <li><a href="herren2.html">2. Herren</a></li>
                        <li><a href="jugend.html">Jugend</a></li>
                        <li><a href="herrenue32.html">Herren Ü32</a></li>
                        <li><a href="herrenue40.html">Herren Ü40</a></li>
                    </ul>
                </li>
    
                <li><a href="termine.html"><h3>Termine</h3></a></li>
                <li><a href="kontakt.html"><h3>Kontakt</h3></a></li>
    
                <!-- Hamburger-Menü direkt mit Dropdown -->
                <li class="dropdown">
                    <div class="hamburger hamburger-icon">
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                    </div>
                    <ul class="dropdown-content">
                        <li><a href="verein.html">Verein</a></li>
                        <li class="dropdown-nested" onclick="toggleSubmenu(this)">
                            <a href="javascript:void(0)" class="nested-toggle">
                                <span>Turnen</span>
                                <span class="arrow-down">▼</span>
                            </a>
                            <ul class="nested-submenu">
                                <li><a href="kinderturnen.html">Kinderturnen</a></li>
                                <li><a href="damenturnen.html">Damenturnen</a></li>
                            </ul>  
                        </li>
                        <li><a href="funlauf.html">Funlauf</a></li>
                        <li><a href="vorstand.html">Vorstand</a></li>
                        <li><a href="sportgruppe.html">Sportgruppe</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </header>

    <h1>Bevorstehende Termine</h1>
    <div class="termine">
        <div class="termine-container" id="termine-liste">
            <!-- Termine werden hier dynamisch geladen -->
        </div>
    </div>

    <footer>
        <p>
            SV Esperke |
            <a href="impressum.html">Impressum</a> |
            <a href="datenschutz.html">Datenschutz</a>
        </p>
    </footer>

    <script>
        async function ladeTermine() {
            const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSbrHTO2TKHfbkTiJzHj4Zg3yoURRR82-U8zxpPKgRC0KeWtttazLbfG9xQ49gStAntJJrcThYWRtdd/pub?output=csv";
            const response = await fetch(url);
            const text = await response.text();

            const zeilen = text.trim().split("\n").slice(1);
            const heute = new Date();
            heute.setHours(0,0,0,0);
            const termine = [];

            zeilen.forEach(zeile => {
                const [datumStr, titel, uhrzeit, kategorie] = zeile.split(",");

                const parts = datumStr.trim().split(".");
                let tag = parseInt(parts[0]);
                let monatName = parts[1].trim();

                const monate = {
                    "Januar": 0, "Februar": 1, "März": 2, "April": 3, "Mai": 4, "Juni": 5,
                    "Juli": 6, "August": 7, "September": 8, "Oktober": 9, "November": 10, "Dezember": 11
                };

                let aktuellesJahr = new Date().getFullYear();
                let aktuellerMonat = new Date().getMonth();
                let jahr = aktuellesJahr;

                if (monate[monatName] < aktuellerMonat) {
                    jahr = aktuellesJahr + 1;
                }

                let datum = new Date(jahr, monate[monatName], tag);

                if (datum >= heute) {
                    let datumAnzeige = `${tag}. ${monatName} ${jahr}`;
                    termine.push({ datum, datumStr: datumAnzeige, titel, uhrzeit, kategorie });
                }
            });

            termine.sort((a,b) => a.datum - b.datum);

            let html = "";
            termine.forEach(t => {
                let klasse = "sonstig";
                if (t.kategorie && t.kategorie.trim().toLowerCase() === "heimspiel") klasse = "heimspiel";
                if (t.kategorie && t.kategorie.trim().toLowerCase() === "auswärtsspiel") klasse = "auswaertsspiel";

                html += `
                <div class="termin ${klasse}">
                    <div class="datum">${t.datumStr}</div>
                    <div class="inhalt">
                        ${t.kategorie ? `<strong>${t.kategorie}:</strong>` : ""} ${t.titel}<br>
                        ${t.uhrzeit ? `<span class="uhrzeit">Beginn: ${t.uhrzeit}</span>` : ""}
                    </div>
                </div>`;
            });

            if (termine.length === 0) {
                html = "<p>Keine anstehenden Termine</p>";
            }

            document.getElementById("termine-liste").innerHTML = html;
        }

        ladeTermine();

        function toggleSubmenu(element) {
            element.classList.toggle('active');
        }
    </script>
</body>
</html>
